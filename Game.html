<!--Assignment 7 - prototype, Eli Bosch, 4/24/24-->
<head>
	<title>Pacman Prototype</title>
	<meta charset="UTF-8">
</head>
<body>
<br>
<canvas id="myCanvas" width="510" height="510" style="border:1px solid #000;"></canvas>

<script type="text/javascript">

//JS classes

const speed = 5;

class Sprite //Parent Sprite Class
{
    //Constructors

	constructor(x, y, w, h, image, update_method, collision_method, deathAnimation)
	{
        //position and size
		this.x = x;
        this.y = y;
        this.w = w;
        this.h = h;
        //speed variables for the ricochet
        this.speedX = -speed;
        this.speedY = speed;
        //animation
        this.cycle = 0;
        this.animation = 0;
        this.frames = 0;
        this.image = image;
        //prototyped methods
        this.update = update_method;
        this.collision = collision_method;
        //removing the sprite
        this.deathAnimation = deathAnimation;
        this.deathAnimationFinished = false;
        this.destroy = false;
	}

    //Getter Methods

    getImage()
    {
        if(this.image instanceof Array) //checks if there are more than one image and handles it
        {
            return this.image[this.cycle][this.animation];
        }
            
        return this.image;
    }

    getRight()
    {
        return (this.x + this.w);
    }

    getBottom()
    {
        return (this.y+this.h);
    }

    getLeft()
    {
        return (this.x);
    }

    getTop()
    {
        return (this.y);
    }

    isDestroyable()
    {
        if(!this.deathAnimation) //If theres a death animation it plays before the sprite is removed
        {
            return this.destroy;
        }
        
        return this.deathAnimationFinished;
        
    }

    //Setter Methods

    setRight(left)
    {
        this.x = left - this.w;
    }

    setBottom(top)
    {
        this.y = top - this.h;
    }

    setLeft(right)
    {
        this.x = right;
    }

    setTop(bottom)
    {
        this.y = bottom;
    }

    setDestroy() //makes sure that destroy is only called once
    {
        if(!this.destroy) {
            this.animation = 0;
            this.cycle = 1;
            this.destroy = true;
        }
    }
   
    //Collision Methods

    isCollidable(sprite2)
    {
        if(this.image == sprite2.image)
            return false;
        return true;
    }

    //Sprite Collisions

    bounce(hori, verti) // to simplify ricochet
    {
        if(hori)
            this.speedX*=-1;
        if(verti)
            this.speedY*=-1;
    }

    push_collision(s)
    {
        let rightCol = s.getRight() - this.getLeft();
        let leftCol = this.getRight() - s.getLeft();
        let upCol = this.getBottom() - s.getTop();
        let downCol = s.getBottom() - this.getTop();

        let minimum = (rightCol < leftCol) ? rightCol : leftCol;
        minimum = (minimum <  upCol) ? minimum : upCol;
        minimum = (minimum < downCol) ? minimum : downCol; //finds which direction that the sprite entered the wall from

        switch(minimum) 
        {
            case rightCol: //removes the sprite from the wall
            {
                s.setRight(this.getLeft() - 1);
                s.bounce(true, false);
            } break;
            case leftCol:
            {
                s.setLeft(this.getRight() + 1);
                s.bounce(true, false);
            } break;
            case upCol:
            {
                s.setTop(this.getBottom() + 1);
                s.bounce(false, true);
            } break;
            case downCol:
            {
                s.setBottom(this.getTop() - 1);
                s.bounce(false, true);
            } break;
        } 
    }

    non_colliding(s) //if the sprite can't collide with other sprites
    {
        
    }

    consume_collision(s) //pacmans collision method
    {
        s.setDestroy();
    }
    

    //Type Specific Update Methods

    ricochet_move() //for the sprites which bounce off the walls
    {
        this.x += this.speedX;
        this.y += this.speedY;
    }


    sit_still() //For non moving sprites
    {

    }

    animate_still()
    {
        this.frames++;

        if(this.frames % 4 == 0) //slows down the animation
        {   
            if(this.animation < this.image[this.cycle].length - 1) 
            {
                this.animation++;
            }else if(this.destroy && this.animation >= this.image[this.cycle].length - 1)
            {
                this.deathAnimationFinished = true; //Ends the death animation
            } else    
            {
                this.animation = 0; //resets the life animation
            }
        } 
    }

    move(x, y) //user controlled sprite movement
    {
        if(x == 0) //Sets the Direction(Cycle) of the pacman image
        {
            if(y > 0)
                this.cycle = 0;
            else    
                this.cycle = 2;
        } else
        {
            if(x > 0)
                this.cycle = 3;
            else    
                this.cycle = 1;
        }

        this.animation++; //211-213 controls the animation of pacman
        if(this.animation > this.image.length - 2) 
            this.animation = 0;

        this.x += x;//actual movement
        this.y += y;
    }
}


//Model Class

class Model
{
	constructor()
	{
		this.sprites = []; //Model holds the images because hardcoding them in Sprite felt like it defeats the purpose of using prototype 
        this.pacmanImages = [];
        this.ghostImages = [];
        this.pelletImage = new Image();
        this.wallImage = new Image();
        this.fruitImage = new Image();
        this.handleImages();

        this.pacman = new Sprite(100, 100, 28, 28, this.pacmanImages, Sprite.prototype.sit_still, Sprite.prototype.consume_collision, false);
        this.sprites.push(this.pacman);
        this.loadModels();
	}

    handleImages() //handles all the images pre prototyping
    {
        this.fruitImage.src = "Images\\spriteImages\\fruit1.png";
        this.wallImage.src = "Images\\wallImages\\wall.png";
        this.pelletImage.src = "Images\\spriteImages\\pellet.png"

        for(let i = 0; i < 2; i++)
        {
            this.ghostImages[i] = [];
            for(let j = 0; j < 8; j++)
            {
                if(i == 0)
                {
                    this.ghostImages[i][j] = new Image();
                    this.ghostImages[i][j].src = "Images\\spriteImages\\blinky" + (1+j) + ".png";
                } else
                {
                    this.ghostImages[i][j] = new Image();
                    this.ghostImages[i][j].src = "Images\\spriteImages\\ghost" + (1+j) + ".png";
                }
            }
        }

        for(let i = 0; i < 4; i++)
        {
            this.pacmanImages[i] = [];
            for(let j = 0; j < 3; j++)
            {
                this.pacmanImages[i][j] = new Image();
                this.pacmanImages[i][j].src = "Images\\pacmanImages\\pacman" + ((i*3) + (j+1)) + ".png";
            }
        }
    }

    //Harcoded map method
    loadModels()
    {
        this.sprites.push(new Sprite(0, 480, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(450, 480, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 420, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 360, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 300, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 420, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 360, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 300, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 270, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 270, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 180, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 180, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 120, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 60, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 0, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 120, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 60, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 0, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(30, 0, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(90, 0, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(120, 0, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(180, 0, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 0, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 0, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(300, 0, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 0, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(390, 0, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(450, 0, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(90, 90, 60, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 90, 60, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 480, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(120, 480, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(150, 480, 90, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 480, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 480, 90, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 390, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 390, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 360, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 390, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 90, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 90, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 90, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 120, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 150, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 180, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 210, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 240, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 270, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 300, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 330, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 120, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 150, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 180, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 210, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 240, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 270, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 300, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 330, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 360, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 510, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 510, 90, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 510, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(150, 510, 90, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(120, 510, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 510, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(450, 510, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 540, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 660, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 780, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 900, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 960, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(480, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 960, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 900, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 780, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 660, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(0, 540, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(90, 660, 60, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(90, 780, 60, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 780, 60, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 660, 60, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 540, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 570, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 600, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 600, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(180, 600, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 600, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(300, 600, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(30, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(60, 960, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(90, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(120, 960, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(150, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(180, 960, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 960, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(300, 960, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(330, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 960, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(390, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(420, 960, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(450, 990, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(30, 930, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(450, 930, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 720, 90, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 780, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 780, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 810, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 780, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 810, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 810, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 840, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 840, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 870, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 900, 90, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 870, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 930, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 930, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 960, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(180, 540, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(210, 570, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 540, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(270, 570, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(120, 450, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 450, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(450, 180, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(450, 270, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(30, 270, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(30, 180, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(120, 210, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 210, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(360, 360, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(90, 360, 60, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(90, 30, 30, 60, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(30, 690, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(240, 630, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(390, 30, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(450, 690, 30, 30, this.wallImage, Sprite.prototype.sit_still, Sprite.prototype.push_collision, false));
        this.sprites.push(new Sprite(40, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 70, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 100, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(70, 100, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(70, 70, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(70, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 130, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 160, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(70, 130, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 160, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(160, 70, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 70, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(160, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(190, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(220, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(250, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(280, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(340, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(370, 40, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(370, 70, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(400, 70, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(340, 100, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(340, 70, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(400, 310, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(400, 220, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(190, 760, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(190, 820, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(190, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(370, 910, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(340, 910, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(430, 910, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(400, 580, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(340, 640, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 670, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(220, 670, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(220, 670, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(160, 610, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 580, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 730, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 760, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(10, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 880, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 880, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 730, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(100, 730, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(220, 670, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(190, 670, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(340, 670, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 760, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(100, 760, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(70, 820, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(190, 880, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(190, 910, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(190, 940, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(160, 940, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(160, 970, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 940, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(100, 940, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(100, 970, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(70, 940, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(40, 910, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(10, 880, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 730, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 730, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 760, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 790, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 820, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 910, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 880, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(370, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(400, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(400, 910, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(400, 940, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 880, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(490, 880, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(490, 850, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 820, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 790, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 760, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 730, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 670, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 610, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(340, 610, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(340, 580, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(310, 640, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(220, 640, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 610, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 640, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(160, 640, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 610, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(10, 610, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 340, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(130, 280, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(460, 250, 10, 10, this.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(247, 367, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(323, 328, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(325, 67, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(323, 144, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(323, 336, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(341, 144, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(463, 868, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(60, 855, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(112, 571, 25, 25, this.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false));
        this.sprites.push(new Sprite(200, 100, 28, 28, this.ghostImages, Sprite.prototype.animate_still, Sprite.prototype.non_colliding, true));
        this.sprites.push(new Sprite(250, 250, 28, 28, this.ghostImages, Sprite.prototype.animate_still, Sprite.prototype.non_colliding, true));
        this.sprites.push(new Sprite(300, 50, 28, 28, this.ghostImages, Sprite.prototype.animate_still, Sprite.prototype.non_colliding, true));
        this.sprites.push(new Sprite(410, 800, 28, 28, this.ghostImages, Sprite.prototype.animate_still, Sprite.prototype.non_colliding, true));
    }
    
    //Pacman Methods

	move(x, y)
    {
        this.pacman.move(x, y); //Calls the pacman method move
    }

    getPac()
    {
        return this.pacman; //For the view to paint pacman on top
    }

    //Detecting Methods

    detectCollision(sprite1, sprite2)
    {
        if(!(sprite1 instanceof Sprite)) //if removed the sprites being removed can cause an error
            return false;
        if(!sprite1.isCollidable(sprite2)) //basic check to make sure no self collision or collision between the same sprites
            return false;
        if(sprite1.getRight() <= sprite2.getLeft())
            return false;
        if(sprite1.getLeft() >= sprite2.getRight())
            return false;
        if(sprite1.getBottom() <= sprite2.getTop())
            return false;
        if(sprite1.getTop() >= sprite2.getBottom())
            return false;

        return true;
    }

    detectWarping(sprite)
    {
        if(sprite.getRight() < 2) //Warps when right side is about to fully cross over
            sprite.setLeft(508); 
        else if(sprite.getLeft() > 508) //same but with the left side
            sprite.setRight(2);
    }

    //Update Methods
    
    update()
	{
		for(let i = 0; i < this.sprites.length; i++)
		{
			this.sprites[i].update(); //updates the sprites
            this.detectWarping(this.sprites[i]); //warps all sprites around the map

            if(this.sprites[i].isDestroyable()) //Checks if any of the sprites were destroyed by pacman
                this.sprites.splice(i, 1); //removes them

            
                

            for(let j = 0; j < this.sprites.length; j++)
            {
                if(this.detectCollision(this.sprites[i], this.sprites[j]) && this.sprites[i] != this.pacman)
                {
                    if(this.sprites[i].image != this.wallImage && this.sprites[j] == this.pacman) //Makes sure that if something runs into pacman its reversed
                        this.sprites[j].collision(this.sprites[i]);
                    else if(this.sprites[i].image == this.wallImage) // This is all other significant collisions
                        this.sprites[i].collision(this.sprites[j]);
                }
            }
		}
	}
}

//View Class

class View
{
	constructor(model)
	{
		this.model = model;
		this.canvas = document.getElementById("myCanvas");
        this.scroll = 0;
	}

    handleScrolling() //Checks if pacman is within the bounds
    {
        if(this.model.getPac().getTop() <  this.scroll + 170)
        {
            this.scroll = this.model.getPac().getTop() - 170; //if not then pacman moves the bounds
        }
        else if (this.model.getPac().getBottom() > this.scroll + 340)
        {
            this.scroll = this.model.getPac().getBottom() - 340;
        }
            
    }

	update()
	{
		let ctx = this.canvas.getContext("2d");
        let pac = this.model.getPac();
		ctx.clearRect(0, 0, 1000, 1000);
		for(let i = 0; i < this.model.sprites.length; i++) //draws the sprites
		{
			let sprite = this.model.sprites[i];
            if(pac != sprite) ctx.drawImage(sprite.getImage(), sprite.x, sprite.y - this.scroll, sprite.w, sprite.h);
		}

        ctx.drawImage(pac.getImage(), pac.x, pac.y - this.scroll, pac.w, pac.h); //draws pacman on top of all other sprites

        this.handleScrolling(); 
	}
}

//Controller Class

class Controller
{
	constructor(model, view)
	{
		this.model = model;
		this.view = view;
        this.mode = 0;
		this.key_right = false;
		this.key_left = false;
		this.key_up = false;
		this.key_down = false;
		let self = this;
		view.canvas.addEventListener('click', function(event) { self.onClick(event); });
		document.addEventListener('keydown', function(event) { self.keyDown(event); }, false);
		document.addEventListener('keyup', function(event) { self.keyUp(event); }, false);
	}

    modeControl(temp) //Used ints bc JS is wack
    {
        switch(this.mode)
        {
            case 0: //if no edit mode is on then editmode needs to be turned on first
            {
                if(temp == 1)
                    this.mode = 1;
            } break;
            case 1:{
                if(temp != 1) //If double tapped it resorts back to playMode -- very easy to implement toggle off of any other mode to playmode but for the sake of convience i chose otherwise
                    this.mode = temp;
                else    
                    this.mode = 0;
            } break;
            case 2: {
                if(temp !=2) //To implement toggling to playmode with editmode i would just add in && temp!=1
                    this.mode = temp; // I would then add an if(temp == 1) this.mode = 0 
                else    
                    this.mode = 0;
            } break;
            case 3:{
                if(temp != 3)
                    this.mode = temp;
                else    
                    this.mode = 0;
            } break;
            case 4: {
                if(temp != 4)
                    this.mode = temp;
                else    
                    this.mode = 0;
            }
        }

        switch(this.mode)
        {
            case 0: console.log("playMode");break; //Console commands to tell the user what mode they are in
            case 1: console.log("editMode");break;
            case 2: console.log("ghostMode");break;
            case 3: console.log("pelletMode");break;
            case 4: console.log("fruitMode");break;
        }
    }

	onClick(event) //Checks what mode the user is in before in places the corresponding sprite
	{
        switch(this.mode) 
        {
            case 0: break; //playMode
            case 1: break; //editMode  
            //ghostMode
            case 2:this.model.sprites.push(new Sprite(event.pageX - this.view.canvas.offsetLeft, event.pageY - this.view.canvas.offsetTop + this.view.scroll, 25, 25, this.model.ghostImages, Sprite.prototype.animate_still, Sprite.prototype.non_colliding, true)); break;
            //pelletMode
            case 3:this.model.sprites.push(new Sprite(event.pageX - this.view.canvas.offsetLeft, event.pageY - this.view.canvas.offsetTop + this.view.scroll, 10, 10, this.model.pelletImage, Sprite.prototype.sit_still, Sprite.prototype.non_colliding, false)); break;
            //fruitMode
            case 4:this.model.sprites.push(new Sprite(event.pageX - this.view.canvas.offsetLeft, event.pageY - this.view.canvas.offsetTop + this.view.scroll, 25, 25, this.model.fruitImage, Sprite.prototype.ricochet_move, Sprite.prototype.non_colliding, false)); break;

        }
	}

	keyDown(event) //Movement
	{
		if(event.keyCode == 39) this.key_right = true;
		else if(event.keyCode == 37) this.key_left = true;
		else if(event.keyCode == 38) this.key_up = true;
		else if(event.keyCode == 40) this.key_down = true;
	}

	keyUp(event)
	{
		if(event.keyCode == 39) this.key_right = false;
		else if(event.keyCode == 37) this.key_left = false;
		else if(event.keyCode == 38) this.key_up = false;
		else if(event.keyCode == 40) this.key_down = false;
        else if(event.keyCode == 69) this.modeControl(1); //editMode
        else if(event.keyCode == 71) this.modeControl(2); //ghostMode
        else if(event.keyCode == 80) this.modeControl(3); //pelletMode
        else if(event.keyCode == 70) this.modeControl(4); //fruitMode

	}

	update() //Movement
	{
        let x = 0;
        let y = 0;

		if(this.key_right) x+=speed;
		if(this.key_left) x-=speed;
		if(this.key_up) y-=speed;
		if(this.key_down) y+=speed;

        if(x != 0 || y!=0)
            this.model.move(x, y)
	}
}

//Game Class

class Game
{
	constructor()
	{
		this.model = new Model();
		this.view = new View(this.model);
		this.controller = new Controller(this.model, this.view);
	}

	onTimer()
	{
		this.controller.update();
		this.model.update();
		this.view.update();
	}
}

let game = new Game();
let timer = setInterval(function() { game.onTimer(); }, 40);

</script>
</body>